<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>나의 자유 게시판</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>자유 게시판</h1>
    
    <div class="input-container" style="margin-bottom: 20px;">
        <input type="text" id="name" placeholder="닉네임" style="padding: 5px;">
        <input type="text" id="text" placeholder="내용을 입력하세요" style="padding: 5px; width: 200px;">
        <button id="sendBtn" style="padding: 5px 15px; cursor: pointer;">등록</button>
    </div>

    <div id="post-list" style="border-top: 1px solid #ccc; padding-top: 20px;">
        <p>글을 불러오는 중입니다...</p>
    </div>

    <script type="module">
        // Firebase 라이브러리 불러오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // 본인의 Firebase Config 정보를 여기에 붙여넣으세요!
        const firebaseConfig = {
  apiKey: "AIzaSyBym7uXM5UhNu_QwoDPAAWiz4nxFNufe9Q",
  authDomain: "mygithome.firebaseapp.com",
  projectId: "mygithome",
  storageBucket: "mygithome.firebasestorage.app",
  messagingSenderId: "532294317956",
  appId: "1:532294317956:web:00da1fe3ae90d53d8fcfd1",
  measurementId: "G-DN7HDDWH54"
};

        // Firebase 초기화
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const postsRef = ref(db, "posts");

        const listDiv = document.getElementById("post-list");

        // 등록 버튼 클릭 이벤트
        document.getElementById("sendBtn").onclick = () => {
            const name = document.getElementById("name").value;
            const text = document.getElementById("text").value;
            if (name && text) {
                push(postsRef, { name, text, time: Date.now() });
                document.getElementById("text").value = ""; // 입력창 비우기
            } else {
                alert("이름과 내용을 모두 입력해 주세요!");
            }
        };

        // 데이터가 추가될 때마다 화면에 표시 (실시간)
        let isFirst = true;
        onChildAdded(postsRef, (snapshot) => {
            if (isFirst) {
                listDiv.innerHTML = ""; // 처음 글이 로드되면 안내 문구 삭제
                isFirst = false;
            }
            const data = snapshot.val();
            const postItem = document.createElement("div");
            postItem.style.borderBottom = "1px solid #eee";
            postItem.style.padding = "10px 0";
            postItem.innerHTML = `<strong>${data.name}</strong>: ${data.text}`;
            listDiv.prepend(postItem); // 최신글이 가장 위로
        });
    </script>
</body>
</html>
